<!DOCTYPE html>
<html lang="mk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Нарачка</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="site-header">
    <nav>
      <a href="index.html" class="btn">Дома</a>
      <a href="products.html" class="btn">Производи</a>
      <a href="about.html" class="btn">За нас</a>
      <a href="contact.html" class="btn">Контакт</a>
      <a href="cart.html" class="btn">Кошничка</a>
    </nav>
  </header>

  <main>
    <h1 class="heading">Форма за нарачка</h1>

    <!-- FormSubmit will deliver the email to your Gmail -->
    <form action="https://formsubmit.co/hookedbyleona@gmail.com" method="POST">
         <!-- Disable Captcha -->
    <input type="hidden" name="_captcha" value="false">
    <!-- Pretty email formatting -->
    <input type="hidden" name="_template" value="table">

    <!-- CART ORDER DATA → auto filled by JS -->
    <textarea name="cart" id="cartData" style="display:none;"></textarea>
      <!-- Customer fields -->
      <label>Име и презиме
        <input type="text" name="full_name" id="full_name" required>
      </label>

      <label>Адреса
        <input type="text" name="address" id="address" required>
      </label>

      <label>Телефонски број
        <input type="tel" name="phone" id="phone" required>
      </label>

      <label>Поштенски код
        <input type="text" name="postal_code" id="postal_code" required>
      </label>

      <label>Место на живеење
        <input type="text" name="city" id="city" required>
      </label>

      <!-- Hidden field for order summary (will be filled by JS) -->
      <input type="hidden" name="order_details" id="order_details">

      <!-- FormSubmit redirect after success -->
      <input type="hidden" name="_next" value="https://your-domain-or-localhost/thankyou.html">
      <input type="hidden" name="_subject" value="Нова нарачка - Hooked by Leona">
      <!-- Disable captcha for convenience (FormSubmit may ignore) -->
      <input type="hidden" name="_captcha" value="false">

      <div class="order-summary">
        <h3>Резиме на нарачката</h3>
        <div id="summaryBox">(косничката ќе биде видлива тука)</div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn">Испрати нарачка</button>
        <a href="cart.html"><button type="button" class="btn">Назад во кошничка</button></a>
      </div>
    </form>
  </main>

  <script src="script.js"></script>
  <script>
    // IMPORTANT: replace _next value in the form above with your real URL path for thankyou.html
    // If you test locally, change to "http://localhost:5500/thankyou.html" or the correct file path.
    // We'll also populate the order summary below when the page loads (script.js provides helpers).
    document.addEventListener('DOMContentLoaded', () => {
      populateOrderForm();
    });

    function prepareAndSend(e) {
      // handled in script.js: collect cart, put formatted text into hidden field "order_details"
      // keep default submit so FormSubmit will POST the form
      return true;
    }
  </script>
  <script>
    // Load cart from localStorage
    const cart = JSON.parse(localStorage.getItem("cart")) || [];

    // Convert cart to readable text
    let output = "";
    cart.forEach(item => {
        output += `${item.name} — ${item.price} ден x ${item.quantity}\n`;
    });

    // Insert into hidden textarea
    document.getElementById("cartData").value = output;
</script>
</body>
</html>
